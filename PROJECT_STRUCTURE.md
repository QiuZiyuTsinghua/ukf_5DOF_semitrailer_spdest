# 半挂卡车5-DOF UKF估计器 - 项目结构说明

## 项目架构

本项目将半挂卡车状态估计功能分解为三个主要模块：

### 1. 车辆动力学模型 (`semitrailer_dynamics.h/cpp`)
- **功能**: 实现半挂卡车平面5-DOF动力学模型
- **状态变量**: [Vx, Vy, r, psi, psi_dot]
  - Vx: 牵引车纵向速度 (m/s)
  - Vy: 牵引车横向速度 (m/s)  
  - r: 牵引车航向角速度 (rad/s)
  - psi: 铰接角 (rad)
  - psi_dot: 铰接角速度 (rad/s)
- **主要功能**:
  - 状态微分方程计算
  - 四阶龙格库塔积分
  - 观测模型
  - 轮胎侧向力计算

### 2. UKF估计器 (`ukf_estimator.h/cpp`)
- **功能**: 实现Unscented Kalman Filter算法
- **特性**:
  - Merwe scaled sigma-points方法
  - 角度归一化处理
  - 可配置噪声协方差
  - 状态不确定度计算
- **主要功能**:
  - 预测步骤 (predict)
  - 更新步骤 (update)  
  - Sigma点生成和变换

### 3. S-Function接口 (`truck_ukf_sfunc.cpp`)
- **功能**: Simulink集成接口
- **职责**:
  - 参数配置和初始化
  - 输入输出数据转换
  - 调用动力学模型和UKF算法
  - 内存管理

## 编译文件
- `compile_mex.m`: MATLAB编译脚本
- `compile_mex.bat`: Windows批处理脚本  
- `README.md`: 使用说明

## 依赖库
- **Eigen3**: 线性代数库 (矩阵运算)
- **Simulink**: S-Function支持

## 工程优势

1. **模块化设计**: 动力学模型、滤波算法、接口分离
2. **可扩展性**: 易于更换不同的车辆模型或滤波算法
3. **可测试性**: 各模块可独立测试验证
4. **可维护性**: 清晰的代码结构和职责分工

## 参数配置

车辆参数需要根据实际半挂卡车进行标定：
- 质量和转动惯量: 通过称重和摆动试验测定
- 几何参数: 实际测量车辆尺寸
- 轮胎参数: 轮胎试验机测定或经验值

## 使用流程

1. 编译MEX文件
2. 在Simulink中配置S-Function模块参数
3. 连接输入输出信号 (使用Mux/Demux)
4. 运行仿真获取状态估计结果
